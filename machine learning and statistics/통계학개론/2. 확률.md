II. 확률
==



## 1. 표본공간, 사상



#### 표본공간(sample space), 원소(element or member)

통계적 실험에서 발생가능한 모든 결과들의 집합을 **표본공간** 이라 한다. 표본공간의 각 결과를 **원소** 라 한다. 



#### 사상(events)

표본공간의 특정한 부분집합을 **사상** 이라 한다.



## 2. 순열과 조합, 경우의 수



#### 순열(permutation) 의 수

$n$개의 서로 다른 대상에 대한 순열의 갯수는 $n!$ 개 이다. $n$개의 서로 다른 대상중 $r$개를 취하여 만든 순열의 수는 ${}_n P_r = \dfrac{n!}{(n-r)!}$ 이다.



#### 원순열(circular permutation)의 수

$n$개의 서로 대상에 대한 원순열의 갯수는 $(n-1)!$ 이다. 



#### 여러 종류에 대한 순열

$k$-개의 종류에 대해 각각 $n_1,\ldots,\,n_k$ 개씩의 원소가 존재한다고 하자. 이 때 대상물의 순열의 수는 다음과 같다.
$$
\dfrac{(n_1+\cdots+n_k))!}{(n_1)!\cdots (n_k)!}\;.
$$


#### 분할(partition)

$n$개의 원소로 이루어진 집합 $A$에 대해 $U_1,\ldots,\,U_k$가 $A$ 의 부분집합이며 $\displaystyle \bigcup_{j=1}^k U_j=A$, $U_i \cup U_j = \varnothing$ for $1 \le i\ne j \le k$, $U_j \ne \varnothing$ for $1 \le j\le k$ 일 때 $U_1,\ldots,\,U_k$를 $A$의 **분할** 이라 한다. 

$n$개의 대상물을 $k$개의 부분집합 $U_1,\ldots,\,U_k$ 로 분할하며 $|U_k|=n_k\ge1$ 일 때의 경우의 수는 다음과 같다.
$$
\begin{pmatrix}n \\ n_1, \;n_2,\;\cdots,\;n_k\end{pmatrix} = \dfrac{n!}{n_1! \cdots n_k!}
$$


#### 조합(combination)

$n$개의 대상물 중 $r$ 개의 원소를 순서에 관계 없이 선택하는 문제를 **조합**이라 한다. 이 때의 경우의 수는 $\begin{pmatrix}n\\r\end{pmatrix}=\dfrac{n!}{r!(n-r)!}$ 이다.



## 3. 사상의 확률



#### 사상의 확률

표본공간 $S$의 사상 $A$를 생각하자. $x_i \in S$ 의 확률을 $w_i$ 라 할 때 $x_i\in A$인 모든 확률의 합을 사상 $A$의 확률이라 하며 $P(A)$ 라 쓴다.



#### 가법정리

$A,\,B$가 표본공간 $S$의 두 사상이라 할 때 다음이 성립한다.
$$
P(A \cup B)=P(A)+P(B)-P(A \cap B)\;.
$$
$A \cap B=\varnothing$ 일 경우 배반이라 하며 이 때 $P(A \cup B)= P(A)+P(B)$ 이다. $A_1,\ldots,\,A_n$ 이  $S$의 분할이면,
$$
P(A_1 \cup \cdots \cup A_n)=P(A_1) + \cdots + P(A_n)=1
$$
이다. 



## 4. 조건부확률, 독립사상, 승법정리

####  조건부 확률(conditional probability)

사상 $A$가 일어났다고 알려진 상황에서 사상 $B$가 일어날 확률을 **조건부 확률** 이라 하고 $P(B|A)$ 라 쓴다. $P(A)>0$ 일 때 다음이 성립한다.
$$
P(B|A)=\dfrac{P(A \cap B)}{P(A)}
$$


#### 독립사상(independent event), 종속 사상(dependent event)

사상 $A,\,B$ 에 대해 $P(A|B)=P(A)$ 이거나 $P(B|A)=P(B)$  일 때 $A,\,B$를 독립사상이라 한다. 즉 $P(A\cap B)= P(A)\cdot P(B)$ 이다. $A,\,B$ 가 독립사상이 아닐 때 종속사상이라 한다.

사상의 집합 $A=\{A_1,\ldots,\,A_n\}$ 의 임의의 부분집합 $A_{i_1},\ldots,\,A_{i_k}$ 에 대해 
$$
P(A_{i1}\cap \cdots \cap A_{i_{k}})=P(A_{i_1}) \cdots P(A_{i_k})
$$
일 때 $A$는 서로 독립 이라 한다.



#### 승법 공식(multiplicative rule)

$P(A\cap B)=P(B|A)\cdot P(A)= P(A|B)\cdot P(B)$ 를 승법공식 이라 한다.



#### 연습문제

<b>2.74</b> 10명의 3학년, 30명의 4학년과 10명의 대학원생이 수강하는 물리학 강좌에서 3명의 3학년 10명의 4학년과 5명의 대학원생이 A 학점을 받았다. 이 반에서 임의로 1명의학생을 택하였을 때 A 학점을 받은 학생이 뽑혔다면 그가 4학년일 확률은?

---

$P(4|A)=P(4\cap A)/P(A)=\dfrac{10}{30} / \dfrac{18}{50}=\dfrac{50}{54}$ 



<b>2.77</b> 어느 고등학교에서 100명의 졸업반 학생이 있다. 그 중에서 42명이 수학 68명이 심리학, 54명이 역사, 22명이 수학과 역사, 25명이 수학과 심리학을 공부하였고, 7명은 역사만 공부하고 수학과 심리학은 공부하지 않았으며, 10명의 학생은 세과목 모두를 공부하였고, 8명은 세 과목중 어느것도 공부하지 않았다. 한 명의 학생이 임의로 선택되었을 때 다음의 확률을 구하라.

(a) 심리학을 공부한 학생이 세 과목 모두를 수강할 확률

(b) 심리학을 택하지 않은 학생이 수학과 역사를 모두 수강할 확률

---

문제의 조건으로 부터 $n(M)=42,\, n(S)=68,\, n(H)=54, n(M\cap H)=22, n(M \cap S)=25$, 

$n(H-M-S)=7, n(H \cap M \cap S)=10, n(H \cup M \cup S)=90$

(a) $P(M\cap S \cap H|S) = P(M\cap S\cap H)/P(S)=\dfrac{10}{100}/\dfrac{68}{100}=\dfrac{10}{68}=\dfrac{5}{34}$

(b) $P(M\cap H|S') = P(M\cap H \cap S')/P(S')=\dfrac{12}{100}/\dfrac{32}{100}=\dfrac{12}{32}=\dfrac{3}{8}$



<b>2.81</b> 기혼남성이 어떤 TV 쇼를 볼 확률은 0.4, 기혼여성이 그 쇼를 볼 확률은 0.5 이다. 부인이 그 쇼를 볼 때 남편이 그 쇼를 볼 확률은 0.7 이다.

(a) 부부가 그 쇼를 볼 확률은?

(b) 남편이 보는 쇼를 그 부인이 볼 확률은?

(c) 부부중 한 사람이 그 쇼를 볼 확률은?

---

$P(M)=0.4,\, P(F)=0.5, P(M|F)=0.7$

(a) $P(M\cap F)=P(M|F)\cdot P(F)=0.7 \cdot 0.5 = 0.35$ 

(b) $P(F|M)=P(F\cap M)\cdot P(M)=0.35/0.4 = 0.875$

(c) $P(M \cup F)=P(M)+P(F)-P(M \cap F)=0.4+0.5-0.35 = 0.55$



<b>2.87</b> 한 부동산업자는 새 집들의 문을 열기 위해 8개의 마스터키를 가지고 있다. 각 집은 오직 하나의 마스터키로만 열 수 있다. 만일 집들의 40%가 잠겨 있지 않다면, 부동산업자가 그의 사무실을 떠나기 전에 임의의 3개의 마스터키만 가지고 간다고 했을 때 특정한 집에 들어갈 수 있을 확률은?

----

집이 열려있을 확률 $P(O)=0.4$, 닫혀있을 확률 $P(C)=0.6$, 마스터키로 열 수 있을 확률 $P(M)=1/8$. 

특정한 집에 들어갈 수 있을 확률 $P(I)=P(O)+P(C)\cdot P(M)\cdot3=0.4+0.225 = 0.625$





## 5. 베이즈 정리



#### 전확률의 정리 (Theorem of total probability)

$B=\{B_1,\ldots,\,B_k\}$ 가 표본공간 $S$의 분할이고 $P(B_j)\ne 0$ for all $j=1,\ldots,\,k$ 라 하자. 이 때 $S$의 임의의 사상 $A$ 에 대해 다음이 성립한다.
$$
P(A)=\sum_{i=1}^k P(B_{i}\cap A)=\sum_{i=1}^k P(B_i) \cdot P(A|B_i)\;.
$$

---

*(proof)*  $B$가 $S$의 분할이므로 $\displaystyle A=\bigcup_{i=1}^k (B_i \cap A)$ 임은 자명하다. 또한 $i \ne j$ 에 대해 $B_i \cap B_j = \varnothing$ 따라서,
$$
P(A) = P\left(\bigcup_{i=1}^k  B_i \cap A\right) = \sum_{i=1}^k P(B_i \cap A)= \sum_{i=1}^k P(B_i) \cdot P(A|B_i)\;.
$$


<b>Example . </b> 3대의 기계 $B_1,\,B_2,\,B_3$ 가 각각 전체 생산량의 30%, 45%, 25% 를 생산하는 어느 조립 공장에서 과거의 경험으로부터 각 기계의 불량품 제조율이 2%, 3%, 2% 임이 알려져 있다. 이제 완제품 중에서 임의로 하나를 선택했을 때 그것이 불량품일 확률은 얼마인가.

---

다음과 같이 정하자.

- $A$ : 제품이 불량품인 사상
- $B_i$: 그 제품이 $B_i$ 에서 조립된 사상

$$
P(A)=\sum_{i=1}^3 P(B_i)\cdot P(A|B_i)=0.3 \times0.02 + 0.45 \times0.3 + 0.25 \times 0.2 = 0.0245
$$



#### 베이즈 정리(Bayes' rule)

$B=\{B_1,\ldots,\,B_n\}$ 이 표본공간 $S$의 분할이고 $P(B_i)\ne 0$ for all $B_i \in B$ 라 하자. 임의의 $S$의 사상 $A$ 에 대해 $P(A)\ne 0$ 에 대해 다음이 성립한다.
$$
P(B_i|A)=\dfrac{P(B_i \cap A)}{\displaystyle \sum_{j=1}^n P(B_j\cap A)} = \dfrac{P(B_i)\cdot P(A|B_i)}{\displaystyle \sum_{j=1}^n P(B_j)\cdot P(A|B_j)}
$$

---

*(proof is trivial)*



<b>Example </b> 위의 example에서 임의로 선택된 제품이 불량품일 때, 그 제품이 기계 $B_3$에서 제조되었을 확률은?
$$
P(B_3|A)=\dfrac{P(B_3\cap A)}{\sum_{j=1}^3 P(A\cap B_j)}=\dfrac{0.25\times0.02}{0.3 \times0.02 + 0.45 \times 0.03 + 0.25 \times 0.02}=\dfrac{10}{49}
$$

#### 연습문제

<b>2.95</b> 어떤 지방에서는 과거의 경험으로 보아 나이가 40세보다 많은 성인이 암을 가지고 있을 확률이 0.05 라고 알려져 있다. 의사가 암환자를 옳게 진단할 확률이 0.78이고, 암환자가 아닌 사람을 환자로 오진할 확률이 0.06이라면, 40세 이상의 어떤 사람이 암환자로 진단될 확률은 얼마인가?

---

40세 이상 암환자일 확률 $P(C)=0.05$, 의사가 암환자를 암환자로 진단할 확률 $P(R)=0.78$. 암환자가 아닌 사람을 환자로 진단할 확률 $P(W)=0.06$. 40세 이상의 어떤 사람이 암환자로 진단될 확률을 $P(C_{40})$ 이라 하면,

$P(C_{40})=P(C)\times p(R)+P(C^C)\times P(W)=0.05 \times 0.78 + 0.95 \times 0.06=0.096$



<b>2.97</b> 2.95에서 암환자라 진단받은 사람이 실제 병에 걸렸을 확률은?

---

$P(C|C_{40})=\dfrac{P(C\cap C_{40})}{P(C\cap C_{40})+P(C^C \cap C_{40})}=\dfrac{0.05\times0.78}{0.05\times 0.78 + 0.95\times 0.06}=0.40625$









