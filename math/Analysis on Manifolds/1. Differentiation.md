I. Differentiation
===

## 0. Basic Notations



## norm and surp norm

$\mathbf{x} \in \mathbb{R}^n$ 에 대해 $\|\mathbf{x}\| = \sqrt{\langle \mathbf{x},\, \mathbf{x}\rangle }$ 을 **norm** of $\mathbf{x}$ 라 하며 $\mathbf{x}=(x_1,\ldots,\,x_n)$ 일 때 $|\mathbf{x}|=\max \{|x_1|,\ldots,\,|x_n|\}$ 을 **sup norm** of $\mathbf{x}$ 라 한다.

$A$ 가 $n \times m$ 행렬 일 때, $|A|$ 를 $|A|=\max \{ |A_{ij}| : i=1,\ldots,\,n \text{ and }j=1,\ldots,\,m \}$ 으로 정의한다.



#### $\delta$-cube around $\mathbf{a}$. 

$\mathbf{a} \in\mathbb{R}^m$ 일 때 $\mathbf{a}$를 중심으로 하고 한 변의 길이가 $2\delta$ 인 정육면체를 $\delta$-cube around $\mathbf{a}$ 라 하고 $C(\mathbf{a};\delta)$ 라 쓰자. 즉, 
$$
C(\mathbf{a};\,\delta)= \{\mathbf{x} \in \mathbb{R}^m : |x_i-a_i|<\delta \text{ for all }i =1,\ldots,\,m \}\;.
$$



#### $\delta$-sphere around $\mathbf{a}$ .

$\mathbf{a}\in \mathbb{R}^m$ 일 때 $\mathbf{a}$를 중심으로 하고 반경이 $\delta$인 $m$-dim sphere를 $\delta$-sphere around $\mathbf{a}$라 하고 $B(\mathbf{a};\delta)$라 쓰자. 즉
$$
B(\mathbf{a};\,\delta)= \{ \mathbf{x} \in \mathbb{R}^m : \|\mathbf{x} -\mathbf{a}\| < \delta\}\;.
$$




#### Theorem 0.1

$A$가 $n \times n$ 행렬이고 $\mathbf{a}\in \mathbb{R}^n$ 일 때, $|A\cdot \mathbf{a}|\le n |A||\mathbf{a}|$ 이다. 

---

*(Proof)* $|(A\cdot\mathbf{a})_i|=\left|\sum\limits_{j=1}^n A_{ij}a_j \right| \le \sum\limits_{j=1}|A_{ij}a_j|\le \sum\limits_{j=1}^n|A_{ij}||a_j| \le \sum\limits_{j=1}^n |A||a_j| \le \sum\limits_{j=1}^n |A||\mathbf{a}| = n|A||\mathbf{a}|$.  

$|A \cdot \mathbf{a}| = \max \{|(A \cdot \mathbf{a})_i : i = 1,\dots,\,n\} \le n|A||\mathbf{a}|$. $\square$



## 1. The Derivative



#### Definition : Directional derivative of a function

Let $A \subset \mathbb{R}^m$, $f: A \to \mathbb{R}^n$.  $A$가 $\mathbf{a}\in A$ 의 어떤 neighborhood를 포함한다고 하자. $\mathbf{u}\in \mathbb{R}^m$, $\mathbf{u} \ne 0$ 에 대해 아래와 같이 극한으로 정의된 $f'(\mathbf{a};\mathbf{u})$ 를 그 극한이 존재할 때 **directional derivative** of $f$ at $\mathbf{a}$ respect to $\mathbf{u}$ 라 한다.
$$
f'(\mathbf{a};\mathbf{u}) = \lim_{t \to 0} \dfrac{f(\mathbf{a}+t\mathbf{u})-f(\mathbf{a})}{t} \;.
$$


1. 위의 정의가 매우 유용하지는 않은데 그 이유중 하나는 direcional derivative $\mathbf{a}$ 의 존재가 $f$ 가 $\mathbf{a}$ 에서 연속임을 보장하지 못하기 때문이다. 게다가 directional derivative가 존재하는 함수의 합성함수가 directional derivative가 존재하지 않을 수도 있다.
2. 따라서 더 유용한 정의가 필요하다.



#### Definition: Differentiablity of multi variable function

Let $A \subset \mathbb{R}^m$, $f:A \to \mathbb{R}^n$. $A$ 가 $\mathbf{a} \in A$ 의 어떤 neighborhood를 포함한다고 하자. 어떤 $n \times m$ 행렬 $B$ 가 존재하여 다음을 만족하면 $f$ 를 **differentiable** at $\mathbf{a}$ 라 하며 이때의 $B$ 를 **derivative** of $f$ at $\mathbf{a}$ 라 하고 $Df(\mathbf{a})$ 라 쓴다.
$$
\lim_{\mathbf{h}\to 0} \dfrac{f(\mathbf{a}+\mathbf{h})-f(\mathbf{a})-B\cdot \mathbf{h}}{|\mathbf{h}|} = 0\;.
$$


#### Theorem 1.1

Let $A \subset \mathbb{R}^m$, $f:A\to \mathbb{R}^n$ . $f$ 가 differentiable at $\mathbf{a}$ 이면 $f$ 의 모든 방향에 대한 directional derivatives at $\mathbf{a}$ 가 존재하며 다음과 같다.
$$
f'(\mathbf{a};\mathbf{u}) = Df(\mathbf{a})\cdot \mathbf{u}\;.
$$

---

*(proof)* Let $\mathbf{h}=t\mathbf{u}$. 



#### Theorem 1.2

 Let $A \subset \mathbb{R}^m$, $f:A\to \mathbb{R}^n$. $f$ 가 differentiable at $\mathbf{a}$ 이면 $f$ 는 $\mathbf{a}$ 에서 연속이다.

---

*(proof)* Let $B=Df(\mathbf{a})$. Then,
$$
f(\mathbf{a}+\mathbf{h}) -f(\mathbf{a}) = |\mathbf{h}| \left[\dfrac{f(\mathbf{a}+\mathbf{h})-f(\mathbf{a})-B\cdot \mathbf{h}}{|\mathbf{h}|}\right] +B\cdot \mathbf{h}
$$
이며 따라서,
$$
\lim_{\mathbf{h} \to 0} f(\mathbf{a}+\mathbf{h}) -f(\mathbf{a}) =0\;. 
$$
$\square$



#### Definition : Partial derivative.

Let $A \subset \mathbb{R}^m$, $f:A\to \mathbb{R}$. Standard basis for $\mathbb{R}^m$ 인  $\mathbf{e}_1,\ldots,\,\mathbf{e}_m$ 을 생각한다. 이 때 $\mathbf{e}_j$ 방향의 directional derivative of $f$ at $\mathbf{a}\in A$를 $j$-th **partial derivative** of $f$ at $\mathbf{a}$라 하고 $D_j f(\mathbf{a})$ 라 쓴다. 즉,
$$
D_j f(\mathbf{a}) = \lim_{t \to 0} \dfrac{f(\mathbf{a}+t\mathbf{e}_j)-f(\mathbf{a})}{t}
$$
이다.



#### Lemma 1.3

Let $A \subset \mathbb{R}^m$, $f:A\to \mathbb{R}$. $f$가 differentiable at $\mathbf{a}$ 이면 다음이 성립한다.
$$
Df(\mathbf{a}) = \left[D_1 f(\mathbf{a})\quad D_2f(\mathbf{a}) \quad\cdots\quad D_m f(\mathbf{a}) \right]\;.
$$

---

*(proof)* 정의에 의해 $Df(\mathbf{a})$ 는 $1 \times m$ 행렬이다. $Df(\mathbf{a}) = [\lambda_1 \quad \lambda_2 \quad \cdots \quad \lambda_m]$ 이라 하자. 그렇다면,
$$
D_j f(\mathbf{a}) = f'(\mathbf{a};\mathbf{e}_j) = Df(\mathbf{a})\cdot \mathbf{e}_j = \lambda_j
$$
 이다. $\square$



#### Theorem 1.4

Let $A \subset \mathbb{R}^m$, $f:A\to \mathbb{R}^n$. $A$가 $\mathbf{a}$의 어떤 neighborhood를 포함한다고 하자. $f_i : A \to \mathbf{R}$ 이 $f$의  $i$-th component 이며 $f$는 $f_i$를 $i$-th row 로 하는 column matrix라 하자. 즉,
$$
f(\mathbf{x})=\begin{bmatrix}f_1 (\mathbf{x})\\ \vdots\\ f_n (\mathbf{x}) \end{bmatrix}\;.
$$


그렇다면 다음이 성립한다.

(a) $f$ is differentiable at $\mathbf{a}$ $\iff$ each $f_i$ is differentiable at $\mathbf{a}$. 

(b) $f$ is differentiable at $\mathbf{a}$ 이면 $Df(\mathbf{a})$ 의 $i,\,j$-component는 $D_j f_i (\mathbf{a})$ 이다. 

---

*(proof)* (a) Define $F(\mathbf{h})$ by,
$$
F(\mathbf{h}) = \dfrac{f(\mathbf{a}+\mathbf{h})-f(\mathbf{a})-B\cdot \mathbf{h}}{|\mathbf{h}|} \;.
$$
Then $F$ is a comumn matrix. $f$ is differentiable at $\mathbf{a}$ $\iff$  $F(\mathbf{a}) = [0 \; \cdots 0]^T $ $\iff$ $f_i$ is differentiable at $\mathbf{a}$. 

(b) Trivial from (a). $\square$



#### Definition : Jacobian matrix

Let $A \subset \mathbb{R}^m$, $f:A\to \mathbb{R}^n$. Theorem 1.4의 $D_j f_i (\mathbf{a})$로 정의된  $n \times m$ 행렬을  **Jacobian matrix** 라 한다. $f$가 differentiable at $\mathbf{a}$ 이면 Jacobina matrix는 $Df(\mathbf{a})$와 같지만 $f$가 not differentiable at $\mathbf{a}$ 이면 단순한 partial derivatives of its components functions의 행렬일 뿐이다.



## 2. Continuously Differentiable Function

#### Theorem 2.1 : Mean value theorem

$\phi : [a,\,b]\subset \mathbb{R} \to \mathbb{R}$ 이 $[a,\,b]$에 연속이며 $(a,\,b)$에서 미분가능하다고 하자. 어떤 $c\in (a,\,b)$에서 다음이 성립한다.
$$
\phi (b)-\phi (a) = (b-a)\phi'(c)\;.
$$

---

*See mathematical anaysis book*



#### Theorem 2.2

$A$가 $\mathbb{R}^m$의 open subset 이며 $f:A \to \mathbb{R}^n$이다. $D_j f_i (\mathbf{x})$가 모든 $\mathbf{x}\in A$에서 존재하며, 연속이면 $f$는 모든 $\mathbf{x}\in A$에서 differentiable 하다.

---

*(proof)* (1) Theorem 1.4에 의해 각각의 $f_i$가 모든 $\mathbf{x}\in A$에서 differentiable 함을 보이면 된다. $A$가 open in $\mathbb{R}^m$ 이므로  모든 $\mathbf{x}\in A$ 에 대해 $\mathbf{x}$를 한 모서리로 하는 아래 그림과 같은 $m$-dim. rectangle을 포함 할 수 있다.$\mathbf{a}$ 와 $\mathbf{a}+\mathbf{h}$ 에 의해 정해지는 직육면체가 $A$에 포함되도록 $\mathbf{h}$를 정하자. $\mathbf{h}=(h_1,\ldots,\,h_m)$ 이라 하고 $\mathbf{p}_0,\,\mathbf{p}_1,\ldots,\,\mathbf{p}_m$ 을 $\mathbf{p}_0=\mathbf{a}$, $\mathbf{p}_k = \mathbf{p}_0 + \sum\limits_{i=1}^k h_i\mathbf{e}_i$ 로 정의하자. 아래 그림은 $m=3$ 이며 모든 $h_i$가 양수일때의 경우이다.

<img src="/Users/jiyong/Documents/notes/analysis on manifolds/fig1.png" alt="fig1" style="zoom:35%;" />

(2) $\psi(\mathbf{x})$ 가 $f$의 임의의 components라 하자. $\psi(\mathbf{a}+\mathbf{h})-\psi(\mathbf{a})= \sum\limits_{j=1}^m [\psi (\mathbf{p}_j) -\psi(\mathbf{p}_{j-1})]$ 이다. $\phi (t)=\psi(\mathbf{p}_{j-1}+t\mathbf{e}_j)$,  $t \in [0,\,h_i]$ 라 하면 $\phi(t)$는 $m$-dim rectangle의 한 모서리에서 정의된다. $D_j f_i$가 $A$에서 존재하므로  $\phi$ 는 $[0,\,h_i]$의 모든 open interval에서 differentiable 하다. Mean value theorem을 생각하면 어떤 $c_j \in (0,\,h_i)$ 에서 다음이 성립한다.
$$
\phi (h_j) -\phi (0) = h_j \phi' (c_j)\;.
$$
따라서,
$$
f_i (\mathbf{p}_j)-f(\mathbf{p}_{j-1}) = D_j f_i(\mathbf{q}_j)h_j
$$
를 만족하는  $\mathbf{q}_j$가 $\mathbf{p}_{j-1}$ 과 $\mathbf{p}_j$ 사이에서 존재한다. 따라서,
$$
f_i (\mathbf{a}+\mathbf{h})-f_i (\mathbf{a}) = \sum_{j=1}^m D_j f_i (\mathbf{q}_j)h_j
$$
이다. 

(3) $B_i = [D_1 f_i(\mathbf{a})\quad \cdots \quad D_m f_i (\mathbf{a})]$  라 하면 $B_i\cdot \mathbf{h} = \sum\limits_{j=1}^m D_j f_i (\mathbf{a})h_j$ 이다. 따라서,
$$
\dfrac{f_i (\mathbf{a}+\mathbf{h})-f_i (\mathbf{a}) -B_i \cdot \mathbf{h}}{|\mathbf{h}|} = \sum_{j=1}^m \dfrac{[D_j f_i (\mathbf{q}_j) - D_jf_i (\mathbf{a})]h_j}{|\mathbf{h}|}
$$
이다. $\mathbf{h} \to 0$ 이면 $\mathbf{q}_j \to \mathbf{a}$ 이며 $D_j f_i$가 $\mathbf{a}$에서 연속이므로, 우변이 $0$ 이 된다. 즉 모든 $f_i$가 differentiable 이므로 $f$도 differentiable.  $\quad \square$



#### Definition : Order of partial derivative, $C^r$ class function.

$f: A\subset \mathbb{R}^m \to \mathbb{R}^n$ 일 때, $D_j f_i$를 1st order partial derivative of $f$,  $D_k (D_jf_i)$ 를  second order partial derivative of $f$ 라 한다. 이렇게 **order of partial derivative** of function을 정의 할 수 있다.

$f$의 $r$-th order partian derivatives가 모두 연속이면 $f$를 **$C^r$ class function** 이라 한다. 모든 order의 partial derivatives가 연속이면 $f$를 $C^{\infty}$ class function 이라 한다.  



#### Theorem 2.3

$A$ 가 $\mathbb{R}^m$의 open subset 이다. $f:A \to \mathbb{R}$이 $C^2$ class function 일 때 모든 $\mathbf{a} \in A$에서 다음이 성립한다.
$$
D_kD_i f(\mathbf{a})=D_iD_kf(\mathbf{a})\;.
$$

---

*(Proof)* (1) $x_i$와 $x_k$를 제외한 component는 constant로 간주할 수 있으므로 $A$가 $\mathbb{R}^2$의 open subset 으로 간주해도 된다.

(2) $Q=[a,\,a+h]\times [b,\,b+k]\subset A$를 생각하자. $\lambda: A \to \mathbb{R}$을 다음과 같이 정의한다.
$$
\lambda (h,\,k ) =f(a,\,b)-f(a+h,\,b) -f(a,\,b+k)+ f(a+h,\,b+k)\;.
$$
(3) Define
$$
\phi (s) = f(s,\,b+k)-f(s,\,b)\;.
$$
그렇다면 $\phi (a+h)-\phi (a) = \lambda(h,\,k)$ 이다. $D_1 f$가 $A$에서 존재하므로 $\phi$는 $[a,\,a + h]$ 에 포함되는 open interval에서 미분가능하다. Mean value theorem에 의해,
$$
\phi(a+h) -\phi(a)= \phi'(s_0)\cdot h
$$
를 만족하는 $s_0\in (a,\,a+h)$가 존재한다. 이 방정식은 다음과 같다.
$$
\lambda(h,\,k)= [D_1 f(s_0,\, b+k)-D_1 f(s_0,\,b)]\cdot h\;.
$$
(4) $f$가 $C^2$ class on $A$ 이므로, 다음을 만족하는 $t_0\in (b,\,b+k)$ 가 존재한다.
$$
D_1 f(s_0,\,b+k)-D_1f(s_0,\,b)=D_2D_1 f(s_0,\,t_0) \cdot k\;.
$$
따라서 $\lambda (h,\,k) = D_2 D_1 f(s_0,\,t_0)\cdot hk$ 를 만족하는 $(s_0,\,t_0) \in (a,\, a+h)\times (b,\,b+k)$ 가 존재한다. 

(5) 같은 방법으로 $\lambda (h,\,k)= D_1D_2 f(s_1,\,t_1)\cdot hk$ 를 만족하는 $(s_1,\,t_1) \in (a,\, a+h)\times (b,\,b+k)$ 도 존재한다.

(6) $\mathbf{a}\in A$ 에서 $Q_t=[a,\,a+t]\times[b,\,b+t]$ 라 하자. $t$ 가 충분히 작다면 $Q_t \in A$ 이다. 따라서
$$
\begin{align*}
\lambda (t,\,t)&= D_2D_1 f(\mathbf{p}_t)\cdot t^2 \quad &\text{for some } \mathbf{p}_t \in A  \;,\\
&= D_1D_2 f(\mathbf{p}'_t)\cdot t^2 &\text{ for some } \mathbf{p}'_t \in A\;.
\end{align*}
$$
이다.  $D_2D_1$ 이 연속이므로 $\lim\limits_{t \to 0} \dfrac{\lambda (t)}{t^2}= D_2 D_1 f(\mathbf{a}) = D_1D_2f(\mathbf{a})$. $\quad \square$



#### Exercises (p. 54~55)

<b>1. </b> $f(x,\,y)= |xy|$ 가 $0$에서 미분가능하지만 어떤 $0$ 의 근방에서도 $C^r$ class 함수가 아님을 보이시오.

---

$Df(0,\,0)= (0,\,0)$ 임은 쉽게 보일 수 있다. 그러나 $D_1 f,\,D_2f$ 는 $(0,\,0)$ 에서 연속이 아니다.



<b>2. </b> $f:\mathbb{R}\to \mathbb{R}$이 다음과 같이 정의되었다.
$$
f(t) = \left\{\begin{array}{ll} t^2 \sin (1/t) \quad &\text{if } t \ne 0\,, \\0 & \text{if }t = 0\;. \end{array}\right.
$$
(a) $f$ 가 $0$에서 미분가능함을 보이고 $f'(0)$ 을 계산하시오.

(b) $t\ne 0$ 일 때 $f'(t)$를 계산하시오.

(c) $f'$이 $0$에서 불연속임을 보이시오.

<b>Note : </b> 따라서  $f$는 $\mathbb{R}$에서 미분가능하지만 $\mathbb{R}$에서 $C^1$ class function은 아니다.

---

(a) $\dfrac{f(s) - f(0)}{s} = s\sin \left(\dfrac{1}{s}\right)$ 이며 $-|s| \le s \sin \left( \dfrac{1}{s} \right) \le |s| $ 이다. 따라서 , $f'(0)=0$ 이다.

(b) $f'(t) = t\sin (1/t)- \cos (1/t)$. 

(c) $\lim\limits_{t \to 0}f'(t) = -1$. 따라서 $f'$은 $0$ 에서 연속이 아니다.



<b>4. </b> $f : A \subset \mathbb{R}^m \to \mathbb{R}$ 에 대해 $f$가 $\mathbf{a}\in A$에서 모든 편미분이 존재하며 $\mathbf{a}$의 어떤 neighborhood 에서 bounded 이면 $f$는 $\mathbf{a}$에서 연속임을 보이시오.

---

(1) Let $N \subset A$ be a neighborhood of $\mathbf{a}$ . 우리는 $\mathbf{a}$를 중심으로 하며  $N$에 포함되는 어떤  $m$-dim cube $C_a=C(\mathbf{a};\, h)$ 를 생각 할 수 있다. 이 cube의 한 변의 길이를 $h$ 라 하자. Threorem 2.2의 증명 과정을 생각해보면,
$$
f(\mathbf{a}+\mathbf{h})-f(\mathbf{a}) = \sum_{j=1}^m D_j f(\mathbf{q}_j)h_j
$$
이다. $\mathbf{q}_j \in C_a$ 이며 $|h_j|\le h$ 임 당연하다. 따라서,
$$
| f(\mathbf{a}+\mathbf{h})-f(\mathbf{a})| =\left|\sum_{j=1}^m D_j f(\mathbf{q}_j)h_j \right| \le \sum_{j=1}^m |D_j f(\mathbf{q}_j)|\cdot |h_j|
$$
 이며 $|D_j f(\mathbf{q})_j|$ 가 bounded 이므로 $f$는 continuous on $\mathbf{a}$ 이다.





<b>9. </b> $g:\mathbb{R}\to \mathbb{R}$ 이 $C^2$-class 일 때 다음을 보이시오.
$$
\lim_{h \to 0} \dfrac{g(a+h)-2g(a)+g(a-h)}{h^2} = g''(a)\;.
$$

---

$g(a+h)-2g(a) - g(a-h)= (g(a+h)-g(a))- (g(a)-g(a-h))=g'(a_1)h-g'(a_2)h$ for some $a_1 \in (a,\,a+h)$ and $a_2 \in (a-h,\,a)$. 

$(g'(a_1)-g'(a_2))\cdot h= g''(a_3)\cdot h^2$ for some $a_3 \in (a_1,\,a_2)\subset (a-h,\,a+h)$ . 



<b>10. </b> $f: \mathbb{R}^2 \to \mathbb{R}$ 이 다음과 같이 정의되었다.
$$
f(x,\,y) = \left\{\begin{array}{ll}\dfrac{xy (x^2-y^2)}{x^2+y^2} \qquad & \text{if } (x,\,y) \ne 0\;, \\ 0 & \text{if } (x,\,y)= 0\;. \end{array}\right.
$$
(a) $D_1f$ 와 $D_2f $가 $0$에서 존재함을 보이시오.

(b) $(x,\,y)\ne 0$ 일 때, $D_1f$와 $D_2 f$를 구하시오.

(c) $f$가 $C^1$-class on $\mathbb{R}^2$ 임을 보이시오. 

(d) $D_2D_1 f$ 와 $D_1D_2 f$가 $0$에서 존재하지만 $D_2D_1 f(0,\,0) \ne D_1D_2 f(0,\,0)$ 임을 보이시오.

---

(a) $D_1 f(0,\,0)= \lim\limits_{t \to 0} (f(t,\,0)-f(0,\,0))= \lim\limits_{t\to 0}f(t,\,0)=\lim\limits_{t \to 0} 0 = 0$.  같은 방법으로 $D_2 f(0,\,0) = 0$ 임을 보일 수 있다.  

(b) $D_1f$



## 3. Chain Rule



#### Theorem 3.1

$A \subset \mathbb{R}^m,\,B\subset \mathbb{R}^n$ 이며 $f:A \to \mathbb{R}^n$ and $g: B \to \mathbb{R}^p$ , $f(A)\subset B$ 이며 $f(\mathbf{a})= \mathbf{b}$ 라 하자. $f$가 $\mathbf{a}$에서 미분가능이며 $g$가  $\mathbf{b}$에서 미분가능 할 때 다음이 성립한다.
$$
D(g \circ f)(\mathbf{a})= Dg(\mathbf{b})\cdot Df(\mathbf{a})\;.
$$

---

*(Proof)* (1) $f$가 $\mathbf{a}$에서 미분가능이고 $g$가 $\mathbf{b}= f(\mathbf{a})$ 에서 미분가능이므로 $A$는 $\mathbf{a}$의 어떤 neighborhood를 포함하며 $B$는 $\mathbf{b}$의 어떤 neighborhoodf를 포함한다. $\varepsilon$\-cube around $\mathbf{b}$, $C_b=C(\mathbf{b};\, \varepsilon)$ 를  open in $B$ 가 되도록 잡을 수 있으며,  $f$가 연속이므로 이므로 $f^{-1}(C_b)$ 는 open in $A$ 이다.  $\mathbf{a} \in f^{-1}(C_b)$ 이므로 $f^{-1}(C_b)$ 에 포함되는 $\delta$-cube around $\mathbf{a}$를 생각 할 수 있다. 이를 $C_a=C(\mathbf{a};\,\delta)$ 라 하자. 

 (2) $C_a$ 에서 정의된  $\Delta (\mathbf{h})= f(\mathbf{a}+\mathbf{h})- f(\mathbf{a})$ 를 생각하자. 즉 $h_i <\delta$ for all $i=1,\ldots,\,m$.  그리고 다음과 같은 함수 $F(\mathbf{h})$ 를 생각하자. 
$$
F(\mathbf{h}) = \left\{\begin{array}{ll} \dfrac{[\Delta (\mathbf{h})-Df(\mathbf{a})\cdot \mathbf{h})]}{|\mathbf{h}|} \quad &\text{for } 0 < |\mathbf{h}|<\delta \;,\\. 0 & \text{for } |\mathbf{h}|=0\;.\end{array} \right.
$$
$f$가 differentiable at $\mathbf{a}$ 이므로 $F$는 $\mathbf{a}$에서 연속이다. 또한 $\Delta (\mathbf{h})= Df(\mathbf{a})\cdot \mathbf{h} + F(\mathbf{h})|\mathbf{h}|$ 이다.

(3) From triangle inequality, $|\Delta (\mathbf{h})|\le |Df(\mathbf{a})\cdot \mathbf{h}| + |F(\mathbf{h})||\mathbf{h}| \le n|Df(\mathbf{a})||\mathbf{h}|+|F(\mathbf{h})||\mathbf{h}|$. 따라서 $|\Delta (\mathbf{h})|/|\mathbf{h}|$ 는 bounded for $\mathbf{h} \ne 0$ 이다.

(4)  같은 방법으로 $|\mathbf{k}|<\varepsilon$ 에 대해 $G(\mathbf{k})$ 를 다음과 같이 정의 할 수 있다. 
$$
G(\mathbf{k}) = \left\{\begin{array}{ll}\dfrac{g(\mathbf{b}+\mathbf{k})-g(\mathbf{b})-Dg(\mathbf{b})\cdot \mathbf{k}}{|\mathbf{k}|} \quad & 0 < |\mathbf{k}|<\varepsilon\;,\\0 & |\mathbf{k}|=0\;. \end{array}\right.
$$
$g(\mathbf{b}+\mathbf{k})-g(\mathbf{b})= G(\mathbf{k})|\mathbf{k}| + Dg(\mathbf{b})\cdot \mathbf{k}$ 이다.
$$
\mathbf{b}+\Delta(\mathbf{h})= f(\mathbf{a})+ \Delta(\mathbf{h}) =f(\mathbf{a}+\mathbf{h})
$$
이므로, 
$$
g(f(\mathbf{a}+\mathbf{h}))- g(f(\mathbf{a})) = Dg(\mathbf{b})\cdot \Delta(\mathbf{h}) + |\Delta (\mathbf{h})|G(\Delta (\mathbf{h}))
$$
이다.  따라서, 
$$
\dfrac{g(f(\mathbf{a}+\mathbf{h}))- g(f(\mathbf{a})) - Dg(\mathbf{b})\cdot Df(\mathbf{a})\cdot \mathbf{h} }{|\mathbf{h}|} = Dg(\mathbf{b})\cdot F(\mathbf{h})+ \dfrac{|\Delta(\mathbf{h})|G(\Delta(\mathbf{h}))}{|\mathbf{h}|}  
$$
이다. 이 식은 $0<|\mathbf{h}|<\delta$ 에서 성립한다. 

$Dg(\mathbf{b})$는 constant 이며 $\lim\limits_{|\mathbf{h}|\to 0}F(\mathbf{h})=0$ 임은 정의로부터 자명하다. (3)에서 $|\Delta(\mathbf{h})|/|\mathbf{h}|$가  $0<|\mathbf{h}|<\delta$ 에서 bounded 임을 보였으며, $\lim\limits_{|\mathbf{h}|\to 0}{\Delta (\mathbf{h})}=0$ 이다. 따라서 $\lim\limits_{|\mathbf{h}|\to 0}G(\Delta (\mathbf{h})) =0$.  이로부터, $D(g\circ f)(\mathbf{a})= Dg(\mathbf{b})\cdot Df(\mathbf{a})$. $\quad \square$



#### Corollary 3.1

$A \subset \mathbb{R}^m,\,B\subset \mathbb{R}^n$ 이며 $f:A \to \mathbb{R}^n$ and $g: B \to \mathbb{R}^p$ , $f(A)\subset B$ 라 하자. $f$와 $g$가 $C^r$-class 이면 $g\circ f$ 도 $C^r$-class 이다.

---

*(Proof)* Induction으로 증명하자 .$r=1$  $(g\circ f)'a = Dg(f(\mathbf{a}))\cdot Df(\mathbf{a})$ 이므로 $g\circ r$ 은 $C^1$-class 이다. $f$와 $g$가 $C^{r-1}$ 이면 $g \circ f$ 도 $C^{r-1}$ 임을 가정하고 $f,\,g$가 $C^r$-class 라 하자. $r$-th order partial derivatives of $g \circ f$ 는  linear combination of partial derivatives of $r-1$ order partial derivative of $g\circ f$ 이다. $f,\,g$ 가 $C^r$-class 이므로 $Df$, $Dg$는 $C^{r-1}$-class 이다. 따라서 $D(g \circ f)$가 $C^{r-1}$ class 이고 $(g \circ f)$ 는 $C^{r}$ class 이다. $\square$



#### Theorem 3.3 (Mean-value theorem)

 $A$가 open in $\mathbb{R}^m$ 이고 $f: A \to \mathbb{R}^n$이 $A$에서  미분가능이라 하자.  $A$가 어떤 $\mathbf{a}+\mathbf{h}$ 부터 $\mathbf{a}$ 까지의 line segment를 포함한다면 다음을 만족하는 $\mathbf{c}$가 line segment 상에서 존재한다.
$$
f(\mathbf{a}+\mathbf{h})-f(\mathbf{a})= Df(\mathbf{c})\cdot \mathbf{h}\;.
$$

----

*(Proof)* Define $\phi :[0,\,1]\to \mathbf{R}^n$ by $\phi(t) =f(\mathbf{a}+t\mathbf{h})-f(\mathbf{a})$. $\phi' (t) = Df(\mathbf{a})\cdot \mathbf{h}$ . From mean value theorem for $1$-variable function, $\phi(t)-\phi (0)= \phi '(s)t$ 를 만족하는 $s\in (0,\,t)$ 가 존재하므로 다음을 다음을 만족하는 $\mathbf{c} = \mathbf{a}+ t_0 \mathbf{h}$ where $t_0\in (0,\,1)$ 이 존재한다.
$$
f(\mathbf{a}+\mathbf{h} )-f(\mathbf{a})= Df(\mathbf{c})\cdot \mathbf{h}\;. \quad \square
$$


#### Theorem 3.4

$A$가 open in $\mathbb{R}^n$ 이고 $f: A \to \mathbf{R}^n$ 이며 $f(\mathbf{a})= \mathbf{b}$ 라 하자. $\mathbf{b}$의 어떤 neighborhood $N$에서 정의된 함수 $g: N \to \mathbf{R}^n$ 이 $g(\mathbf{b})=\mathbf{a}$ 이며 $g \circ f(\mathbf{x}) = \mathbf{x}$ for all $\mathbf{x} $ in some neighborhood of $\mathbf{a}$ 라 하자. $f,\,g$ 가 각각 $\mathbf{a},\,\mathbf{b}$에서 미분가능하다면 다음이 성립한다.
$$
Dg(\mathbf{b})= [Df(\mathbf{a})]^{-1}\;.
$$

---

*(Proof)* Let $i: \mathbb{R}^n \to \mathbb{R}^n$ be an identity function. Then $i'(\mathbf{x})=I_n$. $g \circ f(\mathbf{x})= i (\mathbf{x})$ . $Dg(\mathbf{b})\cdot Df(\mathbf{a})=I_n$. 따라서, $Dg (\mathbf{b})=[Df(\mathbf{a})]^{-1}$.  $\square$



#### Exercise (p. 63 )

<b>1. </b> $f:\mathbb{R}^3 \to \mathbb{R}^2$ 가  $f(\mathbb{0})= (1,\,2)$ 이고 $Df(\mathbf{0})= \begin{bmatrix} 1 & 2 & 3 \\ 0 & 0 & 1\end{bmatrix}$ 라 하자. $g: \mathbf{R}^2 \to \mathbf{R}^2$가 다음과 같이 정의되었다고 하자.
$$
g(x,\,y) = (x+2y+1,\,3xy)
$$
$D(g\circ f)(\mathbf{0})$ 을 구하시오.

---

$Dg (x,\,y) = \begin{bmatrix} 1 & 2 \\ 3y & 3x\end{bmatrix}$. 따라서 $Dg(1,\,2) = \begin{bmatrix} 1 & 2 \\ 6 & 3 \end{bmatrix}$ . 

$D(g \circ f)(\mathbf{0})= Dg(f(\mathbf{0}))\cdot Df(\mathbf{0})= \begin{bmatrix} 1 & 2 \\ 6 & 3\end{bmatrix} \begin{bmatrix} 1 & 2 & 3 \\ 0 & 0 & 1\end{bmatrix}  = \begin{bmatrix} 1 & 2 & 5 \\ 6 & 12 & 21\end{bmatrix}$. 



<b>2. </b> $f:\mathbb{R}^2 \to \mathbb{R}^3$ , $g:\mathbb{R}^3 \to \mathbb{R}^2$가 아래와 같이 정의되었다.
$$
\begin{align*}
f(\mathbf{x}) &= (e^{2x_1+x_2},\,3x_2 - \cos x_1,\, {x_1}^2 + x_2 + 2)\;,\\
g(\mathbf{y}) &= (3y_1+2y_2+ {y_3}^2,\,{y_1}^2 - y_3 + 1)\;.
\end{align*}
$$
(a) $F(\mathbf{x})= g(f(\mathbf{x}))$ 일 때 $DF(\mathbf{0})$ 을 구하시오.

(b) $G(\mathbf{y})=f(g(\mathbf{y}))$ 일 때 $DG(\mathbf{0})$ 을 구하시오.

---

$f(\mathbf{0}) =(1,\,-1,\,2)$. $g(\mathbf{0})= (0,\,1)$. $Df(\mathbf{x})=\begin{bmatrix} 2e^{2x_1+x_2} & e^{2x_1+x_2}\\ \sin x_1 & 3 \\ 2x_1 & 1 \end{bmatrix}$ , $Dg(\mathbf{y})= \begin{bmatrix} 3 & 2 & 2y_3 \\ 2y_1 & 0 & -1\end{bmatrix}$.

(a) $DF(\mathbf{0}) = Dg(f(\mathbf{0}))\cdot Df(\mathbf{0})= \begin{bmatrix}3 & 2 & 6 \\ 2 & 0 & -1\end{bmatrix}\begin{bmatrix} 2 & 1 \\ 0 & 3 \\ 0 &1\end{bmatrix} = \begin{bmatrix}6 & 15 \\ 4 & 1\end{bmatrix}$.

(b) $DG(\mathbf{0}) = Df(g(\mathbf{0})) \cdot Dg(\mathbf{0}) = \begin{bmatrix} 2e & e \\ 0 & 3 \\ 0 &1\end{bmatrix} \begin{bmatrix}3 & 2 & 0 \\ 0 & 0 & -1\end{bmatrix} = \begin{bmatrix} 6e & 4e & -e \\ 0 & 0 & -1\end{bmatrix}$   .



<b>3. </b> $f:\mathbb{R}^3\to \mathbb{R}$, $g: \mathbb{R}^2\to \mathbb{R}$ 이 미분가능하며 $F:\mathbb{R}^2 \to \mathbb{R}$ 이 아래와 같이 정의되었다.
$$
F(x,\,y)= f(x,\,y,\, g(x,\,y))
$$
(a) $DF$ 를 $f$와 $g$의 편미분으로 표현하시오.

(b) $F(x,\,y)=0$ for all $(x,\,y)$ 일 때 $D_1 g$, $D_2g$ 를 $f$의 편미분으로 표현하시오.

---

(1) Define $h: \mathbf{R}^2 \to \mathbf{R}^3$ by $h(x,\,y)= (x,\,y,\,g(x,\,y))$. Then $Dh(x,\,y)= \begin{bmatrix}1 & 0 \\ 0 & 1 \\ D_1g &D_2 g\end{bmatrix}$.

(a) $F(x,\,y)= f(h(x,\,y))$. 따라서, 
$$
\begin{align*}
DF(x,\,y) &= Df(h(x,\,y)) \cdot Dh(x,\,y) = \begin{bmatrix}D_1f(h(x,\,y)) & D_2f(h(x,\,y)) & D_3(h(x,\,y))\end{bmatrix}\cdot Dh(x,\,y) \\
&=\begin{bmatrix}D_1 f + (D_3f) (D_1g) & D_2 f + (D_3f)(D_2 g) \end{bmatrix}

\end{align*}
$$

 (b) $F(x,\,y)=0$ for all $(x,\,y)$ means $DF=0$ for all $(x,\,y)$ 따라서 $D_1g = -(D_1f)/(D_3 f)$, and $D_2 g=-(D_2f)/(D_3f)$. 



<b>4. </b> $g: \mathbb{R}^2 \to \mathbb{R}^2$ 가 $g(x,\,y)= (x,\,y+x^2)$ 이며 $f:\mathbb{R}^2 \to \mathbb{R}$ 이 $f(0,\,0)=0$, $f(x,\,y)= \dfrac{x^2y^2}{x^2y^2+(y-x)^2}$ 로 정의되었다.  $h=f \circ g$ 일 때 모든 $\mathbf{x} \in \mathbb{R}^2$ 에서 $f$와 $g$의 direcitonal derivatives가 존재하지만 어떤 $\mathbf{u}\in \mathbb{R}^2$ 에서 $h(0;\, \mathbf{u})$ 가 존재하지 않음을 보이시오.

---



## 4. Inverse Function Theorem



#### Definition : Singularity of function

Let $A$ be open in $\mathbb{R}^n$ and $f:A \to \mathbb{R}^n$ is a $C^1$ class. 만약 $Df(\mathbf{x})$ 가 모든 $\mathbf{x} \in A$에서 invertible 이면 $Df$를 **non-singular** 하다고 한다. $Df(\mathbf{x})$ 가 non-singular 하지 않으면 **singular** 라 한다.



#### Lemma 4.1

$A$가  open in $\mathbb{R}^n$ 이고  $f:A \to \mathbb{R}^n$ 이  $C^1$ class라 하자. 어떤 $\mathbf{a} \in A$ 에서 $Df(\mathbf{a})$가 non-singular 하다면 어떤 $\alpha >0$ 과  $C_a=C(\mathbf{a};\,\varepsilon)$가 존재하여 모든 $\mathbf{x}_1,\,\mathbf{x}_2\in C_a$ 에서 다음이 성립한다. 
$$
|f(\mathbf{x}_2)-f(\mathbf{x}_1)| \ge \alpha |\mathbf{x}_2-\mathbf{x}_1|\;.
$$
또한  $f|_{C_a}$ 는 injection 이다.

---

*(Proof)* (1) Let $E=Df(\mathbf{a})$. $E$가 non-singular 이므로 $E^{-1}$ 이 존재한다. $\mathbf{x}_1,\,\mathbf{x}_2 \in A$ 에 대해 다음이 성립한다. 
$$
\begin{align*}
|\mathbf{x}_2-\mathbf{x}_1| = |E^{-1}E\cdot (\mathbf{x}_2-\mathbf{x}_1)| \le n|E^{-1}||E\cdot \mathbf{x}_2 -E\cdot \mathbf{x_1|}\;.
\end{align*}
$$
$2\alpha = 1/(n|E^{-1}|)$ 라 하면 $|E\cdot \mathbf{x}_2-E\cdot \mathbf{x}_1| \ge 2\alpha |\mathbf{x}_2-\mathbf{x}_1|$  for all $\mathbf{x}_1,\, \mathbf{x}_2\in A$ 이다.

(2) $H(\mathbf{x})= f(\mathbf{x})- E\cdot \mathbf{x}$ 로 정의한다.  $DH(\mathbf{x})=Df(\mathbf{x})-E$ 이므로 $DH(\mathbf{a})=0$ 이다. $H$는 $C^1$-class 이므로 어떤 $C_a=C(\mathbf{a};\,\delta_{\mathbf{a}})$ 에서  $|DH(\mathbf{x})|<\alpha/n$ for all $\mathbf{x}\in C_a$가 성립한다.  $H$의  $i$-th component function $H_i$에 대해 mean value theorem을 적용하면, 모든 $\mathbf{x}_1,\,\mathbf{x}_2\in C_a$ 에서 다음이 성립한다. 
$$
|H_i (\mathbf{x}_2)-H_i(\mathbf{x}_1)| = |DH_i (\mathbf{c})(\mathbf{x}_2-\mathbf{x}_1)| \le n \left(\dfrac{\alpha}{n}\right) |\mathbf{x}_2-\mathbf{x}_1|=\alpha |\mathbf{x}_2-\mathbf{x}_1|\;.
$$
  (3) 따라서, 
$$
\begin{align*}
\alpha|\mathbf{x}_2-\mathbf{x}_1| &\ge |H_i(\mathbf{x}_2)-H(\mathbf{x}_1)| \\
&= |f(\mathbf{x_2})-E\cdot \mathbf{x}_2 -f(\mathbf{x}_1)+ E\cdot \mathbf{x}_2| \\
&\ge |E\cdot \mathbf{x}_2 - E\cdot \mathbf{x}_1| - |f(\mathbf{x}_2)- f(\mathbf{x}_1)| \\
&\ge 2\alpha|\mathbf{x}_2-\mathbf{x}_1| - |f(\mathbf{x}_2)-f(\mathbf{x}_1)|

\end{align*}
$$
이므로 $|f(\mathbf{x}_2)-f(\mathbf{x}_1)| \ge \alpha |\mathbf{x}_2-\mathbf{x}_1|$ for all $\mathbf{x}_1,\,\mathbf{x}_2 \in C_a$.

(4) $\mathbf{x}_2 \ne \mathbf{x}_1 \implies f(\mathbf{x}_2)\ne f(\mathbf{x}_1)$ for all $\mathbf{x}_1,\,\mathbf{x}_2\in C_a$ 이므로 $f|_{C_a}$ 는  injection. $\square$



#### Lemma 4.2

$A$가 open in $\mathbb{R}^n$ 이고 $\phi : A \to \mathbb{R}$ 이 미분가능하며 $\mathbf{x}_0 \in A$가 local minimum of $\phi$ 이면 $D\phi (\mathbf{x}_0)=\mathbf{0}$ 이다.

---

*(Proof)*  $\mathbf{x}_0 \in A$가 local minimum of $\phi$ 이면 어떤 $\mathbf{x}_0$의  neighborhood $N_0$에 대해 $\phi (\mathbf{x})- \phi (\mathbf{x}_0)\ge 0$ for all $\mathbf{x} \in N_0$ 이다. 즉 임의의  $\mathbf{u}\in \mathbb{R}^n$와  충분히 작은 $t\in \mathbb{R}$에 대해 
$$
\phi(\mathbf{x}_0 +t\mathbf{u})- \phi (\mathbf{x}_0) \ge 0\;.
$$
$$
\phi'(\mathbf{x}_0;\mathbf{u})= \lim_{t \to 0} \dfrac{\phi (\mathbf{x}_0 + t\mathbf{u})- \phi(\mathbf{x}_0)}{t}
$$

인데 $t_+$approach 에서는 $\phi' (\mathbf{x}_0;\mathbf{u})\ge 0$ 이며 $t_{-}$ approach 에서는 $\phi' (\mathbf{x}_0;\, \mathbf{u})\ge 0$ 이다. $\phi$가 $\mathbf{x}_0$ 에서 미분가능하므로 $\phi (\mathbf{x}_0)=0$ 이어야 한다. $\square$



#### Lemma 4.3

$A$가 open in $\mathbb{R}^n$ 이며 $f:A \to \mathbb{R}^n$ 이  $C^r$-class 이며 injection 일 때 $f(A)$는  open in $\mathbb{R}^n$ 이다.

---

*(Proof)* (1) 모든 $\mathbf{y}\in f(A)$ 에 대해 어떤 $C(\mathbf{y};\,\delta
_y ) \subset f(A)$ 이면 $f(A)$는 open in $\mathbf{R}^n$ 이다. Choose $\mathbf{b} \in f(A)$ and find $\mathbf{a} = f^{-1}(\mathbf{b})\in A$. $A$가 open in $\mathbb{R}^n$ 이므로 어떤 $C(\mathbf{a};\,\varepsilon_{\mathbf{a}})$는 $A$ 에 포함된다. Let $Q=C(\mathbf{a};\,\varepsilon_{\mathbf{a}})$. $\operatorname{Bd}(Q)$ 는  compact set 이므로  closed and bounded in $A$. 

(2) $f$가 $C^r$-class 이므로 당연히 연속이다. 따라서 $f(\operatorname{Bd}(Q))$ 는 compact 하며  당연히  closed and bounded.

(3) $f$가  injection 이므로 $\mathbf{b} \not\in f(\operatorname{Bd}(Q))$ . 따라서 어떤 $\mathbf{b}$의  neighborhood $N$이 존재하여 $N \cap f(\operatorname{Bd}(Q))= \varnothing$. $B(\mathbf{b};\, 2\delta)$ 가 $N$에 포함되도록 $\delta$를 잡고 $B_b=B(\mathbf{b};\,\delta)$ 를 생각하자. 즉 모든 $\mathbf{y}_1\in B_b$, $\mathbf{y}_2\in \operatorname{Bd}(Q)$ 에 대해 $\|\mathbf{y}_1-\mathbf{y}_2\|\ge \delta$ 이다. 

(4) 모든 $\mathbf{c} \in B_b$ 에 대해 어떤 $\mathbf{x} \in Q$ 에서 $\mathbf{c}=f(\mathbf{x})$ 임을 보였다고 가정하자. $f$가 연속이므로 $f^{-1}(B_d)$ 는 open in $Q$ 이다. $f$가 injection 이므로 $B_b = (f\circ f)^{-1}(B_b) \subset f(A)$ 이므로  $f(A)$는 open 이 된다. 이것을 보이자. 

(5) $\overline{Q}=Q \cup \operatorname{Bd}(Q)$는 compact  set 이다. 임의의 $\mathbf{c} \in B_b$ 를 선택하고 $\phi : \overline{Q} \to \mathbb{R}$ defined by $\phi(\mathbf{x})= \|f(x) - \mathbf{c}\|^2$ 를 생각한다. $\phi$는 $C^r$ class 이며 $\overline{Q}$ 는 compact set 이므로 $\overline{Q}$에서 minimum 값을 가진다. 

(6) $\phi (\mathbf{a})=\|f(\mathbf{a})-\mathbf{c}\|^2 = \|\mathbf{b}-\mathbf{c}\|^2 <\delta^2$ 이다. 따라서 $\phi$의 minimum 값은 $\delta^2$ 보다 작아야 한다. 

(7) $\phi$의 minimum 이 되도록 하는 $\mathbf{x}_0$는 $Q$에 존재한다. 만약 $\mathbf{x}_0\in \operatorname{Bd}(Q)$ 이면 
$$
\phi (\mathbf{x}_0)=\|f(\mathbf{x}_0)-\mathbf{c}\|^2 \ge \|f(\mathbf{x}_0)-\mathbf{b}\|^2 -\|\mathbf{b}-\mathbf{c}\|^2 \ge 4\delta^2-\delta^2 =3\delta^2
$$

이므로 (5)의 조건에 위배.

(8) $\phi$가 minimum이 되도록 하는 $\mathbf{x}_0$는 $Q$에 존재하며 $Q$는 open 이다. 따라서 Lemma 4.2에 의해 $D\phi (\mathbf{x}_0)=0$ 이 되어야 한다. $\phi(\mathbf{x})= \sum\limits_{k=1}^n (f_k(\mathbf{x})-c_k)^2$ 이므로
$$
D_j \phi (\mathbf{x})={\textstyle \sum\limits_{k=1}^n}2(f_k (\mathbf{x})-c_k)D_j f_k (\mathbf{x})
$$
이다. $D\phi (\mathbf{x}_0 )=0$을 행렬로 쓰면,
$$
2\begin{bmatrix}(f_1(\mathbf{x}_0)-c_1) & \cdots & (f_n(\mathbf{x}_0)-c_n) \end{bmatrix}\begin{bmatrix}D_1f_1 (\mathbf{x}_0) & \cdots &D_nf_1(\mathbf{x}_0) \\ & \ddots  & \\ D_1 f_n (\mathbf{x}_0) & \cdots & D_n f_n (\mathbf{x}_0) \end{bmatrix} =0\;.
$$
이며 오른쪽으 $n\times n$ 행렬이 $Df(\mathbf{x}_0)$ 이다. 문제의 주어진 조건에 의해 $Df(\mathbf{x}_0)$ 가 non-singular 하므로 $f_k (\mathbf{x}_0)  =c_k$ for all $k=1,\ldots,\,n$ 이어야 한다. 즉 모든 $\mathbf{c}\in B_b$에 대해 $f(\mathbf{x})=\mathbf{c}$를 만족하는 $\mathbf{x} \in Q$가 존재하므로 $f(A)$ 는 open 이다.  



#### Lemma 4.4

$A$가  open in $\mathbb{R}^n$ 이며 $f:A\to \mathbb{R}^n$ 이 $C^r$-class 이고 injection 이며 $Df(\mathbf{x})$ 는 $A$에서  non-singular 라 하자. 그렇다면  $g=f^{-1}$ 은 $f(A)$에서 연속이다.

------

*(Proof)* $g$가 연속이라는 것은 모든 open $U$ in $A$에 대해 $g^{-1}(U)$가 open이라는 것과 동치이다. $g^{-1}=f$ 이므로 lemma 4.3에 의해 증명되었다.



#### Lemma 4.5

$A$가  open in $\mathbb{R}^n$ 이며 $f:A\to \mathbb{R}^n$ 이 $C^r$-class 이고 injection 이며 $Df(\mathbf{x})$ 는 $A$에서  non-singular 라 하자. $g=f^{-1}$은 모든 $\mathbf{y}\in f(A)$ 에서 미분가능하다.

---

*(Proof)* (1) Choose $\mathbf{b}\in f(A)$ and let $\mathbf{a} = g(\mathbf{b})$. 또한 $E=Df(\mathbf{a})$ 라  하자. $\Delta (\mathbf{k})= g(\mathbf{b} +\mathbf{k})-g(\mathbf{b})$ 로 정의한다. 

(2) Lemma 4.1에 의해 어떤 $C_a=C(\mathbf{a};\,\varepsilon)$ 과 $\alpha >0$ 이 존재하여 모든 $\mathbf{x}_1,\,\mathbf{x}_2 \in C_a$ 에 대해,
$$
|f(\mathbf{x}_2)-f(\mathbf{x}_1)|\ge \alpha|\mathbf{x}_2-\mathbf{x}_1|
$$
이다. Lemma 4.3에 의해 $f(C_a)$ 는 open 이므로 neighborhood of $\mathbf{b}$ 이다. 

(3) $\mathbf{k}$ 를 충분히 작게 하여 $\mathbf{b}+\mathbf{k}\in C_a$ 가 되로록 잡자. 즉 $|\mathbf{k}|<\varepsilon$ 이면 된다. $\mathbf{x}_2 = g(\mathbf{b}+\mathbf{k})$, $\mathbf{x}_1=g(\mathbf{b})$ 라 하면 (2)의 식은
$$
|(\mathbf{b}+\mathbf{k})-\mathbf{b}| = |\mathbf{k}| \ge \alpha|g(\mathbf{b}+\mathbf{k})-g(\mathbf{b})|
$$
이다. 그렇다면 
$$
\dfrac{1}{\alpha} \ge \dfrac{|\Delta (\mathbf{k})|}{|\mathbf{k}|}
$$
이다. $0 < |\mathbf{k}|<\varepsilon$ 이므로
$$
\dfrac{g(\mathbf{b}+\mathbf{k})-g(\mathbf{b})-E^{-1}\cdot \mathbf{k}}{|\mathbf{k}|}=\dfrac{\Delta(\mathbf{k})-E^{-1}\cdot\mathbf{k}}{|\mathbf{k}|} = -E^{-1}\cdot \left[\dfrac{\mathbf{k}-E\cdot \Delta(\mathbf{k})}{|\Delta (\mathbf{k})|} \right]\dfrac{|\Delta(\mathbf{k})|}{|\mathbf{k}|} \quad \cdots \cdots (1)
$$
이다. $E^{-1}$ 은 constant 이고 $|\Delta (\mathbf{k})|/|\mathbf{k}|$ 는 bounded 이므로 $|\mathbf{k}| \to 0$ limit에서 $[\cdots]$ 가 $0$이라면 우리는 $g$의 미분가능함을 보이게 된다.
$$
\mathbf{b}+\mathbf{k}=f\circ g(\mathbf{b}+\mathbf{k})= f(g(\mathbf{b}+\Delta (\mathbf{k}))=f(\mathbf{a}+\Delta (\mathbf{k}))
$$
이다. 따라서,
$$
\dfrac{\mathbf{k}-E\cdot \Delta (\mathbf{k})}{|\Delta (\mathbf{k})|}=\dfrac{f(\mathbf{a}+\Delta (\mathbf{k}))-f(\mathbf{a})-E\cdot \Delta (\mathbf{k}) }{|\Delta (\mathbf{k})|}
$$
이다. Lemma 4.4에 의해 $g$가 연속이므로 $\lim\limits_{\mathbf{k}\to 0}\Delta (\mathbf{k})=0$ 이다.  따라서  (1) 식의 $[\cdots]=0$ in the $\mathbf{k}\to 0$ limit. 따라서 $g$는 미분가능하다. $\quad\square$



#### Lemma 4.6

$A$가  open in $\mathbb{R}^n$ 이며 $f:A\to \mathbb{R}^n$ 이 $C^r$-class 이고 injection 이며 $Df(\mathbf{x})$ 는 $A$에서  non-singular 라 하자. $g=f^{-1}$은 모든 $\mathbf{y}\in f(A)$ 에서 $C^r$-class 이다.

---

*(Proof)* (1) Lemma 4.5 까지 우리는 $g$가 미분가능함을 보였다. 이제 $g$가 $C^r$-class 임을 보이자.$r$에 대한 induction으로 보이자. 

(2) $g=f^{-1}$ 이 미분가능하므로 theorem 3.4로부터 $Dg(\mathbf{y})=[Df(g^{-1}(\mathbf{y}))]^{-1}$ 임을 안다. 따라서 $g$는 $C^1$-class 이다. 이제 $r-1$ class 까지에 대해 $f$가 $C^{r-1}$ 이면 $g=f^{-1}$ 은 $C^{r-1}$ 임을 가정하자. $f$가 $C^r$ 이면 모든 $D_jf$는 $C^{r-1}$ 이며 따라서 $D_jg$도 $C^{r-1}$ 이다. 따라서 $g$는 $C^r$ 이다. $\square$



#### Theorem 4.7 (Inverse Function Theorem)

$A$가 open in $\mathbb{R}^n$ 이고 $f:A\to \mathbb{R}^n$ 이 $C^r$-class 라 하자. $Df(\mathbf{x})$ 가 non-singular at $\mathbf{a}\in A$ 이면 어떤 $\mathbf{a}$의 neighborhood $U$ 에서 $f|_{U} :U \to \mathbb{R}^n$ 은 injection  이며 $f(U)=f|_U (U)$는 open in $\mathbb{R}^n$ 이며 $(f|_U)^{-1}$ 은 $C^r$-class 이다.

---

*(Proof)* Lemma 4.1에 의해 어떤 neighborhood of $\mathbf{a}$ , $U_0$ 에서 $f$는 injection 이다. $\det Df(\mathbf{x})$ 는 continuous on $A$ 이므로 어떤 $\mathbf{a}$의 neighborhood $U_1$ 에서 $Df(\mathbf{x})$ is non-singular for all $\mathbf{x} \in U_1$. 이다. $U=U_0 \cap U_1$ 이라 하면 $U$는 open in $\mathbb{R}^n$ 이며 Lemma 4.1 ~ Lemma 4.6 까지에 의해 증명된다. $\square$



#### Exercise (p. 70~71)

<b>1. </b> $f:\mathbb{R}^2\to \mathbb{R}^2$ defined by $f(x,\,y)=(x^2-y^2,\, 2xy)$ 를 생각하자.

(a) $A=\{(x,\,y)\in \mathbb{R}^2 : x> 0\}$ 일 때  $f|_A$는 injection 임을 보이시오.

(b) $f(A)$ 는 무엇인가?

(c) $g=f^{-1}$ on $A$ 일 때 $Dg(0,\,1)$ 을 구하시오.

---

(a) $f(x,\,y)=f(a,\,b)$ 이면 $x^2-y^2=a^2-b^2$ and $xy=ab$. 또한 $\|f(x,\,y)\|=\|f(a,\,b)\|$ 이므로 $x^2+y^2 = a^2+b^2$ 이다. 따라서 $x^2=a^2$, $y^2=b^2$. $x=a$ 이고 $y=b$ 이다.

(b) $z=x^2-y^2$, $w=2xy$ 라 하면 $z^2+w^2 = (x^2+y^2)^2$ , $x^2+y^2$는 모든 값을 가질 수 있으므로 $f(A)=\mathbb{R}^2$ 이다.

(c) $Dg(0,\,1)= [Df(g(0,\,1))]^{-1}$ 이다. $Df(x,\,y)=\begin{bmatrix} 2x & -2y \\ 2y & 2x\end{bmatrix}$ 이며, $g(0,\,1)= (1/\sqrt{2},\,1/\sqrt{2})$ 이다. 따라서, 
$$
Dg(0,\,1)=\begin{bmatrix}\sqrt{2} & -\sqrt{2} \\ \sqrt{2} & \sqrt{2} \end{bmatrix}^{-1} = \dfrac{1}{4}\begin{bmatrix}\sqrt{2} & \sqrt{2} \\ -\sqrt{2} & \sqrt{2}\end{bmatrix}.
$$



 <b>2. </b> $f:\mathbb{R}^2 \to \mathbb{R}^2$ defined by $f(x,\,y)= (e^x \cos y,\, e^x \sin y)$ 를 생각하자.

(a) $A=\{(x,\,y) \in \mathbb{R}^2 : 0 < y < 2\pi\}$ 일 때 $f|_A$는 injection 임을 보이시오.

(b) $f(A)$ 는 무엇인가?

(c) $g=f^{-1}$ on $A$ 일 때 $Dg(0,\,1)$ 을 구하시오. 

---

(a) $f(x,\,y)= f(a,\,b)$ 이면 $e^x\cos y = e^a \cos b$, $e^x \sin y = e^a \sin b$. $\|f(x,\,y)|=\|f(a,\,b)\| \implies e^{2x}= e^{2a}$ . 따라서 $x=a$. $\cos y=\cos b$ and $\sin y = \sin b$ 로부터 $y=2n\pi + b$ for some $n \in \mathbb{Z}$. $A$에 한정지으면 $y=b$. 

(b) Let $z=e^x \cos y$ and $w=e^x \sin y$. Then $z^2 + w^2 = e^{2x}>0$ . 따라서 $f(A) = \mathbb{R}^2 - \{(0,\,0)\}$. 

(c) $Dg(0,\,1)=[Df(g (0,\,1))]^{-1}$. $Df(x,\,y)= \begin{bmatrix}e^x \cos y & -e^x \sin y \\ e^x \sin y & e^x \cos y\end{bmatrix}$. $g(0,\,1)= (0,\, \pi/2)$. 따라서
$$
D(g(0,\,1))= \begin{bmatrix} 0 & -1 \\ 1 & 0 \end{bmatrix}^{-1} = \begin{bmatrix} 0 & 1 \\ -1 & 0\end{bmatrix}\;.
$$


<b>3.</b> $f:\mathbb{R}^2 \to \mathbb{R}^2$ 가 $f(\mathbf{x})= \|\mathbf{x}\|^2\cdot \mathbf{x}$ 로 정의되었다. $f$가 $C^{\infty}$-class 임을 보이고 $f(B(\mathbf{0};\,1))= B(\mathbf{0};\,1)$ 이며 $f|_{B(\mathbf{0};\,1)}$ 이 injection 임을 보이시오. 그러나 $f^{-1}$ 은 $0$에서 미분가능하지 않음을 보이시오.

---

(1) $f(x,\,y)= (x^2+y^2)(x,\,y)$ . $f_1,\,f_2$가 모두 $C^\infty$ 이므로 $f$도 $C^\infty$-class 이다. 

(2) $f(x,\,y)=f(a,\,b) \implies (x^2+y^2)x=(a^2+b^2)a$ and $(x^2+y^2)y=(a^2+b^2)b$. $x=a$ $y=b$ 임은 쉽게 보일 수 있다.

(3) $\|f(\mathbf{x})\|= \|\mathbf{x}\|^3$. 따라서 $f(B(\mathbf{0};\,1)) \subset B(\mathbf{0};\,1)$ . $(w,\,z)\in B(\mathbf{0};\,1)$ 이면 $f(x,\,y)=(w,\,z)$ 인 $(x,\,y)\in B(\mathbf{0};\,1)$ 가 존재함을 보이자. $w=(x^2+y^2)x$,  $z=(x^2+y^2)y$ . $w^2+z^2=(x^2+y^2)^3<1$ 이므로 $x=\dfrac{w}{(w^2+z^2)^{1/3}}$, $y=\dfrac{z}{(w^2+z^2)^{1/3}}$ 이며 $(x,\,y)\in B(\mathbf{0};\,1)$ 이다. 따라서 $f(B(\mathbf{0};\,1))=B(\mathbf{0};\,1)$ 이며 $f|_{B(\mathbf{0};\,1)}$ 은 injection 이다. 

(4) $Df(x,\,y)= \begin{bmatrix} 3x^2+y^2 & 2xy \\ 2xy & x^2+3y^2\end{bmatrix}$. $Df(0,\,0)=\begin{bmatrix}0 & 0 \\ 0 & 0\end{bmatrix}$. 



<b>4. </b> Define $g:\mathbb{R}^2\to \mathbb{R}^2$ and $f:\mathbb{R}^2 \to \mathbb{R}^3$ as 

$$
g(x,\,y)= (2ye^{2x},\, xe^y)\\
f(x,\,y)= (3x-y^2,\, 2x+y,\, xy+y^3)\;.
$$

(a) $g$는 어떤 neighborhood of $(0,\,1)$를 $(2,\,0)$의 neighborhood로 injective 하게 보냄을 보이시오.

(b) $D(f\circ g^{-1})(2,\,0)$ 을 구하시오.

---

(a) $Dg(x,\,y) = \begin{bmatrix}4ye^{2x} & 2e^{2x} \\ e^y & xe^y\end{bmatrix}$. 따라서 $Dg(0,\,1)= \begin{bmatrix}4 & 2 \\ e & 0\end{bmatrix}$ 으로 non-singular. $g(0,\,1)= (2,\,0)$ 

(b) $D(f\circ g^{-1})(2,\,0)= Df(g^{-1}(2,\,0))\cdot D(g^{-1})(2,\,0)$ .
$$
Df(x,\,y) = \begin{bmatrix}3 & -2y \\ 2 & 1 \\ y & x+3y^2\end{bmatrix}
$$
따라서 $Df(g^{-1}(2,\,0))= Df(0,\,1)= \begin{bmatrix} 3 & -2 \\ 2 & 1 \\ 1 & 3 \end{bmatrix}$. 이며 $D(g^{-1})(2,\,0)= [Dg(0,\,1)]^{-1}= \dfrac{1}{2e}\begin{bmatrix} 0 & 2 \\ e & -4 \end{bmatrix}$. 

$D(f\circ g^{-1})(2,\,0) = \dfrac{1}{2e}\begin{bmatrix} 2e & 14 \\ -e & 0 \\ -3e & -10\end{bmatrix}$. 



<b>5. </b> $A$가 open in $\mathbb{R}^n$, $f:A \to \mathbb{R}^n$ 이 $C^r$-class 라 하자. $Df$ 가 non-singular for every $\mathbf{x}\in A$ 라면 $f$가 injection이 아니더라도 $f(A)$는 open in $\mathbb{R}^n$ 임을 보이시오.

---

$Df(\mathbf{x})$ 가 non-singular 이면 $\mathbf{x}$의 어떤  neighborhood $U$ 에서 $f(\mathbf{x})$ 의 어떤 neighborhood $V$로 injective 하게 보낸다. 즉 $f|_U :U \to V$는 injection 이다. 모든 $\mathbf{y}\in f(A)$ 에 대해 $f(\mathbf{x})=\mathbf{y}$ 일 때 $\mathbf{x}$ 근처의 어떤 neighborhood $U_x$에서 $f(U_x)$ 는 $\mathbf{y}$를 포함하는 open set in $f(A)$ 이다. 따라서 $f(A)$ 는 open in $\mathbb{R}^n$. 



 #### 5. Implicit Function Theorem



#### Notation : Representation of Jacobian

$A$가 $\mathbb{R}^m$의 open subset 이고 $f: A\to \mathbb{R}^n$ 이 differentiable 이며 $f_i$는 $f$의 $i$-th component function 이라 하자. $Df$를 때때로 다음과 같이 표현한다.
$$
Df = \dfrac{\partial (f_1,\ldots,\,f_n)}{\partial (x_1,\ldots,\,x_m)}\;.
$$
혹은 줄여서,
$$
Df = \dfrac{\partial f}{\partial \mathbf{x}} = \partial f/\partial \mathbf{x}
$$
와 같이 표현할 수 있다. 모두 $n \times m$ matrix 이다.



#### Theorem 5.1 

$A$가 open in $\mathbb{R}^{k+n}$ 이고 $f:A \to \mathbb{R}^n$ 이 differentiable 이라 하자. $\mathbf{x}\in \mathbb{R}^k$, $\mathbf{y}\in \mathbb{R}^n$ 에 대해  $f$를 $f(\mathbf{x},\,\mathbf{y})$ 로 나타 낼 수 있으며 $Df$는 아래와 같은 form을 가진다. 
$$
Df = \begin{bmatrix}\dfrac{\partial f}{\partial \mathbf{x}} & \dfrac{\partial f}{\partial \mathbf{y}} \end{bmatrix}\;.
$$
어떤 open $B\in \mathbb{R}^k$ 에서 정의된 $g:B \to \mathbb{R}^n$ 이 differentiable 이며 $f(\mathbf{x},\, g(\mathbf{x}))=0$ for all $\mathbf{x}\in B$ 라 하자. 그렇다면 모든 $\mathbf{x}\in B$ 에서 다음이 성립한다.
$$
\dfrac{\partial f}{\partial \mathbf{x}}(\mathbf{x},\,g(\mathbf{x}))+ \dfrac{\partial f}{\partial \mathbf{y}}(\mathbf{x},\,g(\mathbf{x}))  \cdot Dg(\mathbf{x})=0\;.
$$

---

*(Proof)* (1) Define $h: B \to \mathbb{R}^{k+n}$ by $h (\mathbf{x}) = (\mathbf{x},\,g(\mathbf{x}))$ and $H:B \to \mathbf{R}^n$ by $H(\mathbf{x})= f(h(\mathbf{x})) = f(\mathbf{x},\,g(\mathbf{x}))$.  

(2) From the chain rune, 
$$
\begin{align*}
0 & = DH(\mathbf{x}) = Df(h(\mathbf{x})) \cdot Dh(\mathbf{x}) \\
&= \begin{bmatrix} \dfrac{\partial f}{\partial \mathbf{x}}(h(\mathbf{x})) & \dfrac{\partial f}{\partial \mathbf{y}} (h(\mathbf{x})) \end{bmatrix}\cdot \begin{bmatrix}I_k \\ Dg(\mathbf{x})\end{bmatrix} \\
&= \dfrac{\partial f}{\partial \mathbf{x}}(h(\mathbf{x})) + \dfrac{\partial f}{\partial \mathbf{y}}(h(\mathbf{x}))\cdot Dg(\mathbf{x})\;. \quad \square
\end{align*}
$$



#### Theorem 5.2 (Implicit Function Theorem)

$A$가 open in $\mathbb{R}^{k+n}$ 이고 $f:A \to \mathbb{R}^n$ 이 $C^r$-class 라 하자. $\mathbf{x}\in \mathbb{R}^k$, $\mathbf{y}\in \mathbb{R}^n$ 에 대해 $f=f(\mathbf{x},\,\mathbf{y})$ 로 쓸 수 있다. $\mathbf{a}\in \mathbb{R}^k$, $\mathbf{b}\in \mathbb{R}^n$ 이 $(\mathbf{a},\,\mathbf{b}) \in A$ 이며 $f(\mathbf{a},\,\mathbf{b})=0$ 이고,
$$
\det \dfrac{\partial f}{\partial\mathbf{y}}(\mathbf{a},\,\mathbf{b}) \ne0
$$
이라 하자. 그렇다면 어떤 $\mathbf{a}$ 의 neighborhood $B$와 unique한 연속함수 $g :B \to \mathbf{R}^n$ 이 존재하여 $g(\mathbf{a})=\mathbf{b}$ 이며 모든 $\mathbf{x}\in B$ 에서
$$
f(\mathbf{x},\,g(\mathbf{x}))=0
$$
을 만족하게 한다. 또한 $g$ 역시 $C^r$-class 이다.

---

*(Proof)* (1) Inverse function theorem을 적용 하여 증명한다. $F : A \to \mathbb{R}^{k+n}$ 을 다음과 같이 정의한다.
$$
F(\mathbf{x},\,\mathbf{y}) = (\mathbf{x},\,f(\mathbf{x},\,\mathbf{y}))
$$
그렇다면 
$$
DF =\begin{bmatrix} I_k & 0 \\ \dfrac{\partial f}{\partial \mathbf{x}} & \dfrac{\partial f}{\partial \mathbf{y}}\end{bmatrix}
$$
이다. $\det (DF)(\mathbf{a},\,\mathbf{b})= \det (\partial f/\partial \mathbf{y})(\mathbf{a},\,\mathbf{b}) \ne 0$ 이다. 따라서 $DF$는 non-singular 하다. 

(2) $F(\mathbf{a},\,\mathbf{b})= (\mathbf{a},\,0)$ 이다. Inverse function theorem 에 의해 어떤 $(\mathbf{a},\,\mathbf{b})$의 neighborhood $U \times V$ (where $U$ is open in $\mathbb{R}^k$ and $V$ is open in $\mathbb{R}^n$ ) 와 open subset of $\mathbb{R}^{k+n}$ including $(\mathbf{a},\,0)$, $W$, 에서 $F : U \times V \to W$ 는 injection 이다. 그리고 $F$의 inverse function $G: F(U \times V) \subset W \to U \times V$ 는 $C^r$-class 이다.

(3) $F(\mathbf{x},\,\mathbf{y}) = (\mathbf{x},\,f(\mathbf{x},\,\mathbf{y}))$ 이므로 $G(\mathbf{x},\,f(\mathbf{x},\,\mathbf{y})) = (\mathbf{x},\,\mathbf{y})$ 이다. $G$가 첫번째 $\mathbf{x} \in \mathbb{R}^k$ 를 보존하므로 $\mathbf{z}\in \mathbb{R}^n$ 을 도입하여 $G(\mathbf{x},\,\mathbf{z}) = (\mathbf{x},\,h(\mathbf{x},\,\mathbf{z}))$ 로 쓸 수 있다. $h$는 $h: F(U\times V) \to \mathbb{R}^n$ 함수이다. 

(4) $B$를 connected neighborhood of $\mathbf{a}$ 이며 $B\times \mathbf{0}$ 이 $W$에 포함되도록 작게 잡을 수 있다. $\mathbf{x}\in B$ 이면 $(\mathbf{x},\,0)\in B\times \mathbf{0}$ 이며, 다음이 성립한다.  
$$
\begin{align*}
G(\mathbf{x},\,\mathbf{0})&= (\mathbf{x},\,h(\mathbf{x},\,\mathbf{0}))\, ,\\
(\mathbf{x},\,\mathbf{0}) &= F(\mathbf{x},\,h(\mathbf{x},\,\mathbf{0})) = (\mathbf{x},\,f(\mathbf{x},\,h(\mathbf{x},\,\mathbf{0})))\;, \\
\mathbf{0} &= f(\mathbf{x},\, h(\mathbf{x},\,\mathbf{0}))\;.
\end{align*}
$$
(5) Define $g: B \to \mathbb{R}^n$ by $g(\mathbf{x})=h(\mathbf{x},\,\mathbf{0})$. Then $\mathbf{0}=f(\mathbf{x},\,g(\mathbf{x}))$. 더우기 
$$
(\mathbf{a},\,\mathbf{b})=G(\mathbf{a},\,\mathbf{0}) = (\mathbf{a},\,h(\mathbf{a},\,\mathbf{0}))
$$
이므로 $g(\mathbf{a})=\mathbf{b}$ 이다. 

(6) 이제 uniqueness 를 증명하자. $g_0 : B \to \mathbb{R}^n$ 이 주어진 조건을 만족하는 또 다른 함수라 하자. $g_0 (\mathbf{a}_0)= g(\mathbf{a}_0)$ for $\mathbf{a}_0 \in B$ 이며 $\mathbf{a}_0$ 의 어떤 neighborhood $B_0$ 에서 $g_0 = g$ 라 하자. 

*to be completed*



<b>Example 1. </b> $A$ 가 open in $\mathbb{R}^5$ 이고 $f:A \to \mathbb{R}^2$ 가 $C^r$-class 라 하자. $\mathbf{x}_0=(x_0,\,y_0,\,z_0,\,u_0,\,v_0)\in A$ 일 때  $\det \dfrac{\partial (f_1,\,f_2)}{\partial (y,\,u)}(\mathbf{x}_0)\ne 0$ 이면 implicit function theorem에 의해 어떤 neighborhood of $\mathbf{x}_0$, $N_0$와  $\phi,\,\psi : N_0 \to \mathbb{R}$ 이 존재하여  $f(x,\, \phi (x,\,z,\,w),\,z,\,\psi(x,\,z,\,w),\,w)=0$ 이 되도록 한다는 것이다. 또한 이 때 $\phi,\,\psi $는 $C^r$-class 이다. 

Theorem 9.1에 의해, 다음이 성립한다.
$$
\dfrac{\partial (\phi,\,\psi)}{\partial (x,\,z,\,v)} = - \left[\dfrac{\partial f}{\partial (y,\,u)}\right]^{-1}\cdot \left[\dfrac{\partial f}{\partial (x,\,z,\,v)}\right]
$$
<b>Example 2.</b> $f:\mathbb{R}^2 \to \mathbb{R}$ defined by $f(x,\,y)= x^2 + y^2-5$ 를 생각하자. $f(1,\,2)=0$ 이다. $\partial f/\partial x \ne 0$ and $\partial f/\partial y\ne 0$ at $(1,\,2)$ 이므로 어떤 $(1,\,2)$ 의 neighborhood $N_1$ 과 $\phi :N_1 \to \mathbb{R}$ 이 존재하여 $f(x,\,\phi (x))=0$ 이며 또한 $(1,\,2)$ 의 어떤 neighborhood $N_2$와 $\psi :N_2 \to \mathbb{R}$ 이 존재하여 $f(\psi (y),\,y)=0$ 이다. 



#### Exercise (pp. 78 ~ 79)

<b>1. </b> $f:\mathbb{R}^3 \to \mathbb{R}^2$ 가 $C^1$-class 이며 $f$를  $f(x,\,y_1,\,y_2)$ 라 쓰자. $f(3,\,-1,\,2)=0$, $Df(3,\,-1,\,2)= \begin{bmatrix}1 & 2 & 1 \\ 1 & -1 & 1\end{bmatrix}$ 이라 하자. 

(a) $\mathbb{R}$ 의 어떤 open set $B$ 에서 정의된 함수 $g:B \to \mathbb{R}^2$ of $C^1$-class 가 존재하여 $f(x,\,g_1(x),\,g_2(x))=\mathbf{0}$ for all $x\in B$ 이며 $g(3)=(-1,\,2)$ 를 만족 함을 보이시오. 

(b) $Dg(3)$를 구하시오.

(c) $f(x,\,y_1,\,y_2)=0$ 을 만족시키는 해를  $(3,\,-1,\,2)$ 근처의 임의의 point 에서 에서 $x=\phi(y_2)$, $y_1=\psi (y_2)$ 로 구하는 것을 논하시오.

---

(a) $\det \left( \dfrac{\partial (f_1,\,f_2)}{\partial (y_1,\,y_2)} (3,\,-1,\,2)\right) = \det \left(\begin{bmatrix} 2 & 1 \\ -1 & 1 \end{bmatrix} \right) = 3 \ne 0$ 이므로 implicit function theorem 에 의해 어떤 $(3,\,-1,\,2)$ 의 neighborhood $B$ 가 존재하여 $f(x,\,g_1(x),\,g_2 (x))=\mathbf{0}$ for all $x\in B$ 이며 $g(3) = (-1,\,2)$ 이다.

(b) $Dg(3) = - \left[\dfrac{\partial (f_1,\,f_2)}{\partial (y_1,\,y_2)}(3,\,-1,\,2) \right]^{-1} \cdot \dfrac{\partial (f_1,\,f_2)}{\partial x}(3) = -\begin{bmatrix}2 & 1 \\ -1 & 1\end{bmatrix}^{-1} \begin{bmatrix} 1 \\ 1\end{bmatrix} = (0,\,-1)$ 

(c) $\det \left( \dfrac{\partial (f_1,\,f_2)}{\partial (x,\,y_1)} (-3,\,-1,\,2)\right) =  \det \left(\begin{bmatrix}1 & 2 \\ 1 & -1\end{bmatrix} \right) $



<b>2. </b> $f:\mathbb{R}^5 \to \mathbb{R}^2$ 가 $C^1$-class 이고 $\mathbf{a}=(1,\,2,\,-1,\,3,\,0)$ 이라 하자 $f(\mathbf{a})=0$, $Df(\mathbf{a})= \begin{bmatrix}1 & 3 & 1 & -1 & 2 \\ 0 & 0 & 1 & 2 &-4\end{bmatrix}$ 라 하자. 

(a) $\mathbf{a}$의 어떤 neighborhood $B$ 에서 정의된 $C^1$-class function $g:B \to \mathbb{R}^2$ 가 존재하여 모든 $\mathbf{x}=(x_1,\,x_2,\,x_3) \in B$ 에 대해 
$$
g(x_1,\,g_1(\mathbf{x}),\,g_2(\mathbf{x}),\,x_2,\,x_3)=\mathbf{0}
$$
이며 $g(1,\,3,\,0)=(2,\,-1)$  임을 보이시오.

(b) $Dg(1,\,3,\,0)$ 을 구하시오.

(c) 

---

(a) Let $f=f(x_1,\,y_1,\,y_2,\,x_2,\,x_3)$. $\det \left(\dfrac{\partial (f_1,\,f_2)}{\partial (y_1,\,y_2)}(\mathbf{a}) \right) =\det \left(\begin{bmatrix} 3 & 1 \\ 0 & 1  \end{bmatrix}\right) = 3 \ne 0$.   implicit function theorem에 의해 자명하다. 

(b) 

$$
\begin{align*}
Dg(3)  &= -\left[\dfrac{\partial (f_1,\,f_2)}{\partial (y_1,\,y_2)} (\mathbf{a})\right]^{-1} \cdot \left[\dfrac{\partial (f_1,\,f_2)}{\partial (x_1,\,x_2,\,x_3)}(1,\,0,\,3)\right] \\
&= -\begin{bmatrix} 3 & 1 \\ 0 & 1  \end{bmatrix} \cdot \begin{bmatrix}1 & -1 & 2 \\ 0 & 2 & -4\end{bmatrix} = \begin{bmatrix}3 & -1 & 2 \\ 0 & 2 & -4\end{bmatrix}\;.
\end{align*}
$$


<b>3. </b> $f: \mathbb{R}^2 \to \mathbb{R}$ 이 $C^1$-class function  이며 $f(2,\,-1)= -1$ 이라 하자. $G,\,F:\mathbb{R}^3 \to \mathbb{R}$ 을 다음과 같이 정의한다. 
$$
\begin{align*}
F(x,\,y,\,u) &= f(x,\,y)+ u^2\;,\\
G(x,\,y,\,y) &= ux+3y^3+u^3\;.
\end{align*}
$$
$G(x,\,y,\,u)=0$ 과 $F(x,\,y,\,u)=0$ 은 공통해 $(2,\,-1,\,1)$ 을 가진다.

(a) 어떤 $Df$의 조건에서 $\mathbb{R}^2$ 의 open set 위에서 존재하며, $C^1$-class 이고 $x=g(y),\,u=h(y)$ s.t. $g(-1)=2$ and $h(-1)=1$ 인 $g,\,h :\mathbb{R}\to \mathbb{R}$ 이 존재하나?

(b) (a) 의 존건에서 $Df(2,\,-1)= \begin{bmatrix}1 & -3 \end{bmatrix}$ 일 때 $g'(-1)$과 $h'(-1)$ 을 구하시오.

---

(1) $DF = \begin{bmatrix} D_1 f & D_2 f & 2u \end{bmatrix}$ and $DG=\begin{bmatrix}u & 9y^2 & x+3u^2 \end{bmatrix}$. $DG(2,\,-1,\,1)= \begin{bmatrix} 1 & 9 & 5\end{bmatrix}$. 

(a) $\dfrac{\partial F}{\partial y} (2,\,-1,\,1) = D_2 f(2,\,-1) \ne  0$ 이면 된다. 

(b) 

